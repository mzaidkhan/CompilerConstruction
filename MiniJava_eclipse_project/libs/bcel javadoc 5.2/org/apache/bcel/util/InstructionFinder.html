<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>InstructionFinder</title>
    <meta name="keywords" content="org.apache.bcel.util.InstructionFinder,InstructionFinder class" />
    <meta name="generator" content="SinjDoc 0.5" />
    <link href="../../../../stylesheet.css" rel="stylesheet" type="text/css" />
    <link rel="Index" href="../../../../index-all.html" />
    <link rel="Start" href="../../../../overview-summary.html" />
    <link rel="Up" href="package-summary.html" />
    <link rel="Help" href="../../../../help-doc.html" />
  </head>
  <body class="classPage bigframe">
   <div class="navbar">
    <p class="nav navtop">
      <span class="over"><a href="../../../../overview-summary.html">Overview</a></span>
      <span class="package"><a href="package-summary.html">Package</a></span>
      <span class="class selected">Class</span>
      <span class="use"><a href="class-use/InstructionFinder.html">Use</a></span>
      <span class="tree"><a href="package-tree.html">Tree</a></span>
      <span class="deprecated"><a href="../../../../deprecated-list.html">Deprecated</a></span>
      <span class="index"><a href="../../../../index-all.html">Index</a></span>
      <span class="help"><a href="../../../../help-doc.html">Help</a></span>
    </p>
    <p class="nav navmid">
      <span class="prevnext">
       <span class="prev">Prev Class</span>
       <span class="next">Next Class</span>
      </span>
      <span class="framesel">
       <span class="frames"><a href="../../../../index.html" target="_top">Frames</a></span>
       <span class="noframes"><a href="InstructionFinder.html" target="_top">NoFrames</a></span>
      </span>
      <span class="allclasses"><a href="../../../../allclasses-noframe.html">All Classes</a></span>
   </p>
   <p class="nav navbot">
      <span class="summary">Summary:
       <span class="nested"><a href="#nested_class_summary">Nested</a></span>
       <span class="field"><a href="#field_summary">Field</a></span>
       <span class="constr"><a href="#constructor_summary">Constr</a></span>
       <span class="method"><a href="#method_summary">Method</a></span>
      </span>
      <span class="detail">Detail:
       <span class="field"><a href="#field_detail">Field</a></span>
       <span class="constr"><a href="#constructor_detail">Constr</a></span>
       <span class="method"><a href="#method_detail">Method</a></span>
      </span>
   </p>
    <div class="navtitle">
     
    </div>
    <p class="clear"><!--empty--></p>
   </div>
   <p class="packageName">org.apache.bcel.util</p>
   <h1>  Class  InstructionFinder</h1>
<!--
   <p class="enclosing">
   Enclosing class/interface: @OUTER@
   </p>
-->


   <!-- XXX class hierarchy diagram goes here -->
<!--
   
   <p class="directSubclasses">
   Direct known subclasses: @ALL_SUBCLASSES@
   </p>
-->


   <p class="declaration">public
     class 
   <span class="className">InstructionFinder</span>
   
   
      
      <span class="extends">extends Object</span>
      
      
   
   </p>

   <div class="description">
   
 InstructionFinder is a tool to search for given instructions patterns, i.e.,
 match sequences of instructions in an instruction list via regular
 expressions. This can be used, e.g., in order to implement a peep hole
 optimizer that looks for code patterns and replaces them with faster
 equivalents.
 
 <p>
 This class internally uses the <a href="http://jakarta.apache.org/regexp/">
 Regexp</a> package to search for regular expressions.
 
 A typical application would look like this:
 
 <pre>
 
  
   InstructionFinder f   = new InstructionFinder(il);
   String            pat = &quot;IfInstruction ICONST_0 GOTO ICONST_1 NOP (IFEQ|IFNE)&quot;;
   
   for(Iterator i = f.search(pat, constraint); i.hasNext(); ) {
   InstructionHandle[] match = (InstructionHandle[])i.next();
   ...
   il.delete(match[1], match[5]);
   ...
   }
   
  
 </pre>
<p class="tag tag_version"><span class="tagName">Version:</span> <span class="tagContents">$Id: InstructionFinder.java 386056 2006-03-15 11:31:56Z tcurdt $</span> </p>
<p class="tag tag_author"><span class="tagName">Author:</span> <span class="tagContents"><A HREF="mailto:m.dahm@gmx.de">M. Dahm</A></span> </p>
<p class="tag tag_see"><span class="tagName">See Also:</span> <span class="tagContents"><a href="../generic/Instruction.html" class="classRef">Instruction</a></span> <span class="tagContents"><a href="../generic/InstructionList.html" class="classRef">InstructionList</a></span> </p>

   </div>



   <table class="nested_class_summary summary">
     <tr><th colspan="2"><a name="nested_class_summary" id="nested_class_summary">Nested Class Summary</a></th></tr>

     <tr><td>static interface</td><td><span class="memberName"><a href="InstructionFinder.CodeConstraint.html" class="interfaceRef">InstructionFinder.CodeConstraint</a></span><div class="memberDescription">
 Code patterns found may be checked using an additional user-defined
 constraint object whether they really match the needed criterion. </div></td></tr>

   </table>




   <table class="field_summary summary">
     <tr><th colspan="2"><a name="field_summary" id="field_summary">Field Summary</a></th></tr>

     <tr><td> <a href="../generic/InstructionHandle.html" class="classRef">InstructionHandle</a>[]</td><td><span class="memberName"><a href="#handles" class="fieldRef">handles</a></span><div class="memberDescription"></div></td></tr>



     <tr><td> <a href="../generic/InstructionList.html" class="classRef">InstructionList</a></td><td><span class="memberName"><a href="#il" class="fieldRef">il</a></span><div class="memberDescription"></div></td></tr>



     <tr><td> String</td><td><span class="memberName"><a href="#il_string" class="fieldRef">il_string</a></span><div class="memberDescription"></div></td></tr>



     <tr><td>static Map</td><td><span class="memberName"><a href="#map" class="fieldRef">map</a></span><div class="memberDescription"></div></td></tr>



     <tr><td>static int</td><td><span class="memberName"><a href="#NO_OPCODES" class="fieldRef">NO_OPCODES</a></span><div class="memberDescription"></div></td></tr>



     <tr><td>static int</td><td><span class="memberName"><a href="#OFFSET" class="fieldRef">OFFSET</a></span><div class="memberDescription"></div></td></tr>

   </table>




   <table class="constructor_summary summary">
     <tr><th colspan="2"><a name="constructor_summary" id="constructor_summary">Constructor Summary</a></th></tr>

     <tr><td> </td><td><span class="memberName"><a href="#InstructionFinder(org.apache.bcel.generic.InstructionList)" class="constructorRef">InstructionFinder</a>(<a href="../generic/InstructionList.html" class="classRef">InstructionList</a> il)</span><div class="memberDescription"></div></td></tr>

   </table>




   <table class="method_summary summary">
     <tr><th colspan="2"><a name="method_summary" id="method_summary">Method Summary</a></th></tr>

     <tr><td>static  String</td><td><span class="memberName"><a href="#compilePattern(<unknown>.String)" class="methodRef">compilePattern</a>(String pattern)</span><div class="memberDescription">
 Replace symbolic names of instructions with the appropiate character and
 remove all white space from string. </div></td></tr>



     <tr><td>  <a href="../generic/InstructionList.html" class="classRef">InstructionList</a></td><td><span class="memberName"><a href="#getInstructionList()" class="methodRef">getInstructionList</a>()</span><div class="memberDescription"></div></td></tr>



     <tr><td>  <a href="../generic/InstructionHandle.html" class="classRef">InstructionHandle</a>[]</td><td><span class="memberName"><a href="#getMatch(int,int)" class="methodRef">getMatch</a>(int matched_from, int match_length)</span><div class="memberDescription"></div></td></tr>



     <tr><td>static  char</td><td><span class="memberName"><a href="#makeChar(short)" class="methodRef">makeChar</a>(short opcode)</span><div class="memberDescription">
 Convert opcode number to char.</div></td></tr>



     <tr><td>static  String</td><td><span class="memberName"><a href="#mapName(<unknown>.String)" class="methodRef">mapName</a>(String pattern)</span><div class="memberDescription">
 Map symbolic instruction names like "getfield" to a single character.
</div></td></tr>



     <tr><td>static  String</td><td><span class="memberName"><a href="#pattern2string(<unknown>.String)" class="methodRef">pattern2string</a>(String pattern)</span><div class="memberDescription"></div></td></tr>



     <tr><td>static  String</td><td><span class="memberName"><a href="#pattern2string(<unknown>.String,boolean)" class="methodRef">pattern2string</a>(String pattern, boolean make_string)</span><div class="memberDescription"></div></td></tr>



     <tr><td>static  String</td><td><span class="memberName"><a href="#precompile(short,short,short)" class="methodRef">precompile</a>(short from, short to, short extra)</span><div class="memberDescription"></div></td></tr>



     <tr><td>  void</td><td><span class="memberName"><a href="#reread()" class="methodRef">reread</a>()</span><div class="memberDescription">
 Reread the instruction list, e.g., after you've altered the list upon a
 match.</div></td></tr>



     <tr><td>  Iterator</td><td><span class="memberName"><a href="#search(<unknown>.String,org.apache.bcel.generic.InstructionHandle,org.apache.bcel.util.InstructionFinder.CodeConstraint)" class="methodRef">search</a>(String pattern, <a href="../generic/InstructionHandle.html" class="classRef">InstructionHandle</a> from, <a href="InstructionFinder.html" class="classRef">InstructionFinder</a>.<a href="InstructionFinder.CodeConstraint.html" class="interfaceRef">CodeConstraint</a> constraint)</span><div class="memberDescription">
 Search for the given pattern in the instruction list. </div></td></tr>



     <tr><td>  Iterator</td><td><span class="memberName"><a href="#search(<unknown>.String)" class="methodRef">search</a>(String pattern)</span><div class="memberDescription">
 Start search beginning from the start of the given instruction list.
</div></td></tr>



     <tr><td>  Iterator</td><td><span class="memberName"><a href="#search(<unknown>.String,org.apache.bcel.generic.InstructionHandle)" class="methodRef">search</a>(String pattern, <a href="../generic/InstructionHandle.html" class="classRef">InstructionHandle</a> from)</span><div class="memberDescription">
 Start search beginning from `from'.
</div></td></tr>



     <tr><td>  Iterator</td><td><span class="memberName"><a href="#search(<unknown>.String,org.apache.bcel.util.InstructionFinder.CodeConstraint)" class="methodRef">search</a>(String pattern, <a href="InstructionFinder.html" class="classRef">InstructionFinder</a>.<a href="InstructionFinder.CodeConstraint.html" class="interfaceRef">CodeConstraint</a> constraint)</span><div class="memberDescription">
 Start search beginning from the start of the given instruction list. </div></td></tr>

   </table>



<!--
   <p class="inherited">
    <span class="header">Methods inherited from class java.util.<a
   href="AbstractCollection.html">AbstractCollection</a></span>
    <a href="#addAll">addAll</a>
    <a href="#contains">contains</a>
   </p>
   <p class="inherited">
    <span class="header">Methods inherited from class java.lang.<a
   href="Object.html">Object</a></span>
    <a href="#addAll">clone</a>
    <a href="#contains">finalize</a>
   </p>
   <p class="inherited">
    <span class="header">Methods inherited from interface java.util.<a
   href="List.html">List</a></span>
    <a href="#addAll">addAll</a>
    <a href="#contains">contains</a>
   </p>
-->



   <h2><a name="field_detail" id="field_detail">Field Detail</a></h2>

   <h3><a name="handles" id="handles">handles</a></h3>
   <div class="memberName">private <a href="../generic/InstructionHandle.html" class="classRef">InstructionHandle</a>[] handles</div>
   <div class="memberDescription"></div>


   <h3><a name="il" id="il">il</a></h3>
   <div class="memberName">private <a href="../generic/InstructionList.html" class="classRef">InstructionList</a> il</div>
   <div class="memberDescription"></div>


   <h3><a name="il_string" id="il_string">il_string</a></h3>
   <div class="memberName">private String il_string</div>
   <div class="memberDescription"></div>


   <h3><a name="map" id="map">map</a></h3>
   <div class="memberName">private static final Map map</div>
   <div class="memberDescription"></div>


   <h3><a name="NO_OPCODES" id="NO_OPCODES">NO_OPCODES</a></h3>
   <div class="memberName">private static final int NO_OPCODES</div>
   <div class="memberDescription"></div>


   <h3><a name="OFFSET" id="OFFSET">OFFSET</a></h3>
   <div class="memberName">private static final int OFFSET</div>
   <div class="memberDescription"></div>




   <h2><a name="constructor_detail" id="constructor_detail">Constructor Detail</a></h2>

   <h3><a name="InstructionFinder(org.apache.bcel.generic.InstructionList)" id="InstructionFinder(org.apache.bcel.generic.InstructionList)">InstructionFinder</a></h3>
   <div class="memberName">public  InstructionFinder(<a href="../generic/InstructionList.html" class="classRef">InstructionList</a> il)</div>
   <div class="memberDescription"><p class="tag tag_param"><span class="tagName">Parameters:</span> <span class="tagContents">il
          instruction list to search for given patterns</span> </p>
</div>




   <h2><a name="method_detail" id="method_detail">Method Detail</a></h2>

   <h3><a name="compilePattern(<unknown>.String)" id="compilePattern(<unknown>.String)">compilePattern</a></h3>
   <div class="memberName">private static final  String compilePattern(String pattern)</div>
   <div class="memberDescription">
 Replace symbolic names of instructions with the appropiate character and
 remove all white space from string. Meta characters such as +, * are
 ignored.
<p class="tag tag_param"><span class="tagName">Parameters:</span> <span class="tagContents">pattern
          The pattern to compile</span> </p>
<p class="tag tag_return"><span class="tagName">Returns:</span> <span class="tagContents">translated regular expression string</span> </p>
</div>


   <h3><a name="getInstructionList()" id="getInstructionList()">getInstructionList</a></h3>
   <div class="memberName">public final  <a href="../generic/InstructionList.html" class="classRef">InstructionList</a> getInstructionList()</div>
   <div class="memberDescription"><p class="tag tag_return"><span class="tagName">Returns:</span> <span class="tagContents">the inquired instruction list</span> </p>
</div>


   <h3><a name="getMatch(int,int)" id="getMatch(int,int)">getMatch</a></h3>
   <div class="memberName">private  <a href="../generic/InstructionHandle.html" class="classRef">InstructionHandle</a>[] getMatch(int matched_from, int match_length)</div>
   <div class="memberDescription"><p class="tag tag_return"><span class="tagName">Returns:</span> <span class="tagContents">the matched piece of code as an array of instruction (handles)</span> </p>
</div>


   <h3><a name="makeChar(short)" id="makeChar(short)">makeChar</a></h3>
   <div class="memberName">private static final  char makeChar(short opcode)</div>
   <div class="memberDescription">
 Convert opcode number to char.</div>


   <h3><a name="mapName(<unknown>.String)" id="mapName(<unknown>.String)">mapName</a></h3>
   <div class="memberName">private static final  String mapName(String pattern)</div>
   <div class="memberDescription">
 Map symbolic instruction names like "getfield" to a single character.
<p class="tag tag_param"><span class="tagName">Parameters:</span> <span class="tagContents">pattern
          instruction pattern in lower case</span> </p>
<p class="tag tag_return"><span class="tagName">Returns:</span> <span class="tagContents">encoded string for a pattern such as "BranchInstruction".</span> </p>
</div>


   <h3><a name="pattern2string(<unknown>.String)" id="pattern2string(<unknown>.String)">pattern2string</a></h3>
   <div class="memberName">private static final  String pattern2string(String pattern)</div>
   <div class="memberDescription"></div>


   <h3><a name="pattern2string(<unknown>.String,boolean)" id="pattern2string(<unknown>.String,boolean)">pattern2string</a></h3>
   <div class="memberName">private static final  String pattern2string(String pattern, boolean make_string)</div>
   <div class="memberDescription"></div>


   <h3><a name="precompile(short,short,short)" id="precompile(short,short,short)">precompile</a></h3>
   <div class="memberName">private static  String precompile(short from, short to, short extra)</div>
   <div class="memberDescription"></div>


   <h3><a name="reread()" id="reread()">reread</a></h3>
   <div class="memberName">public final  void reread()</div>
   <div class="memberDescription">
 Reread the instruction list, e.g., after you've altered the list upon a
 match.</div>


   <h3><a name="search(<unknown>.String,org.apache.bcel.generic.InstructionHandle,org.apache.bcel.util.InstructionFinder.CodeConstraint)" id="search(<unknown>.String,org.apache.bcel.generic.InstructionHandle,org.apache.bcel.util.InstructionFinder.CodeConstraint)">search</a></h3>
   <div class="memberName">public final  Iterator search(String pattern, <a href="../generic/InstructionHandle.html" class="classRef">InstructionHandle</a> from, <a href="InstructionFinder.html" class="classRef">InstructionFinder</a>.<a href="InstructionFinder.CodeConstraint.html" class="interfaceRef">CodeConstraint</a> constraint)</div>
   <div class="memberDescription">
 Search for the given pattern in the instruction list. You can search for
 any valid opcode via its symbolic name, e.g. "istore". You can also use a
 super class or an interface name to match a whole set of instructions, e.g.
 "BranchInstruction" or "LoadInstruction". "istore" is also an alias for all
 "istore_x" instructions. Additional aliases are "if" for "ifxx", "if_icmp"
 for "if_icmpxx", "if_acmp" for "if_acmpxx".
 
 Consecutive instruction names must be separated by white space which will
 be removed during the compilation of the pattern.
 
 For the rest the usual pattern matching rules for regular expressions
 apply.
 <P>
 Example pattern:
 
 <pre>
 search(&quot;BranchInstruction NOP ((IfInstruction|GOTO)+ ISTORE Instruction)*&quot;);
 </pre>
 
 <p>
 If you alter the instruction list upon a match such that other matching
 areas are affected, you should call reread() to update the finder and call
 search() again, because the matches are cached.
<p class="tag tag_param"><span class="tagName">Parameters:</span> <span class="tagContents">pattern
          the instruction pattern to search for, where case is ignored</span> <span class="tagContents">from
          where to start the search in the instruction list</span> <span class="tagContents">constraint
          optional CodeConstraint to check the found code pattern for
          user-defined constraints</span> </p>
<p class="tag tag_return"><span class="tagName">Returns:</span> <span class="tagContents">iterator of matches where e.nextElement() returns an array of
         instruction handles describing the matched area</span> </p>
</div>


   <h3><a name="search(<unknown>.String)" id="search(<unknown>.String)">search</a></h3>
   <div class="memberName">public final  Iterator search(String pattern)</div>
   <div class="memberDescription">
 Start search beginning from the start of the given instruction list.
<p class="tag tag_param"><span class="tagName">Parameters:</span> <span class="tagContents">pattern
          the instruction pattern to search for, where case is ignored</span> </p>
<p class="tag tag_return"><span class="tagName">Returns:</span> <span class="tagContents">iterator of matches where e.nextElement() returns an array of
         instruction handles describing the matched area</span> </p>
</div>


   <h3><a name="search(<unknown>.String,org.apache.bcel.generic.InstructionHandle)" id="search(<unknown>.String,org.apache.bcel.generic.InstructionHandle)">search</a></h3>
   <div class="memberName">public final  Iterator search(String pattern, <a href="../generic/InstructionHandle.html" class="classRef">InstructionHandle</a> from)</div>
   <div class="memberDescription">
 Start search beginning from `from'.
<p class="tag tag_param"><span class="tagName">Parameters:</span> <span class="tagContents">pattern
          the instruction pattern to search for, where case is ignored</span> <span class="tagContents">from
          where to start the search in the instruction list</span> </p>
<p class="tag tag_return"><span class="tagName">Returns:</span> <span class="tagContents">iterator of matches where e.nextElement() returns an array of
         instruction handles describing the matched area</span> </p>
</div>


   <h3><a name="search(<unknown>.String,org.apache.bcel.util.InstructionFinder.CodeConstraint)" id="search(<unknown>.String,org.apache.bcel.util.InstructionFinder.CodeConstraint)">search</a></h3>
   <div class="memberName">public final  Iterator search(String pattern, <a href="InstructionFinder.html" class="classRef">InstructionFinder</a>.<a href="InstructionFinder.CodeConstraint.html" class="interfaceRef">CodeConstraint</a> constraint)</div>
   <div class="memberDescription">
 Start search beginning from the start of the given instruction list. Check
 found matches with the constraint object.
<p class="tag tag_param"><span class="tagName">Parameters:</span> <span class="tagContents">pattern
          the instruction pattern to search for, case is ignored</span> <span class="tagContents">constraint
          constraints to be checked on matching code</span> </p>
<p class="tag tag_return"><span class="tagName">Returns:</span> <span class="tagContents">instruction handle or `null' if the match failed</span> </p>
</div>

   
   <div class="navbar">
    <p class="nav navtop">
      <span class="over"><a href="../../../../overview-summary.html">Overview</a></span>
      <span class="package"><a href="package-summary.html">Package</a></span>
      <span class="class selected">Class</span>
      <span class="use"><a href="class-use/InstructionFinder.html">Use</a></span>
      <span class="tree"><a href="package-tree.html">Tree</a></span>
      <span class="deprecated"><a href="../../../../deprecated-list.html">Deprecated</a></span>
      <span class="index"><a href="../../../../index-all.html">Index</a></span>
      <span class="help"><a href="../../../../help-doc.html">Help</a></span>
    </p>
    <p class="nav navmid">
      <span class="prevnext">
       <span class="prev">Prev Class</span>
       <span class="next">Next Class</span>
      </span>
      <span class="framesel">
       <span class="frames"><a href="../../../../index.html" target="_top">Frames</a></span>
       <span class="noframes"><a href="InstructionFinder.html" target="_top">NoFrames</a></span>
      </span>
      <span class="allclasses"><a href="../../../../allclasses-noframe.html">All Classes</a></span>
   </p>
   <p class="nav navbot">
      <span class="summary">Summary:
       <span class="nested"><a href="#nested_class_summary">Nested</a></span>
       <span class="field"><a href="#field_summary">Field</a></span>
       <span class="constr"><a href="#constructor_summary">Constr</a></span>
       <span class="method"><a href="#method_summary">Method</a></span>
      </span>
      <span class="detail">Detail:
       <span class="field"><a href="#field_detail">Field</a></span>
       <span class="constr"><a href="#constructor_detail">Constr</a></span>
       <span class="method"><a href="#method_detail">Method</a></span>
      </span>
   </p>
    <div class="navtitle">
     
    </div>
    <p class="clear"><!--empty--></p>
   </div>
   <div class="bottom"></div>
   </body>
</html>
